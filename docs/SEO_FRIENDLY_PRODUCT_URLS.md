# SEO-Friendly Product URLs - Implementation Guide

## üéØ Problem Solved: Non-Descriptive and SEO-Unfriendly Product URLs

This document outlines the transition from ID-based product URLs to descriptive, SEO-friendly slug-based URLs.

## üö® Previous Issues

Previously, product URLs were structured using a non-descriptive CUID, like this:
`/product/cmg8hrqfr0000xy1ye9bepdny`

This approach had several drawbacks:
- **Poor User Experience:** URLs were not human-readable and gave no context about the product.
- **Bad for SEO:** Search engines prefer descriptive URLs that contain relevant keywords.
- **Difficult to Share:** Ugly URLs are less likely to be shared.
- **404 Errors:** As seen, any issue with fetching by ID would result in a "Page Not Found" error.

## ‚úÖ Solution Implemented: Slug-Based URLs

We have implemented a new URL structure that uses a human-readable "slug" generated from the product's name.

The new URL structure looks like this:
`/product/smart-tv-sansei-led-full-hd`

### Benefits:
- **Improved SEO:** Keywords in the URL can improve search engine rankings.
- **Better User Experience:** URLs are readable and provide immediate context.
- **Increased Shareability:** Clean URLs are more appealing to share.

## üîß Implementation Details

Here is a step-by-step breakdown of the changes made to implement this feature.

### 1. Database Schema Update (`prisma/schema.prisma`)

A new `slug` field was added to the `Product` model. It is a `String`, and it must be `@unique` to ensure that every product has a unique URL.

```prisma
// file: prisma/schema.prisma

model Product {
  id          String      @id @default(cuid())
  name        String
  slug        String      @unique // <-- ADDED
  description String
  price       Float
  stock       Int
  imageUrls   String[]
  orderItems  OrderItem[]
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
}
```

### 2. Database Migration

After updating the schema, a new database migration was created and applied to update the database structure. This is done with the following command:

```bash
npx prisma migrate dev --name add-product-slug
```

### 3. Slug Generation for Existing Products

To update existing products in the database, a script is needed to generate a slug for each one. A slug is generated by:
1. Taking the product `name`.
2. Converting it to lowercase.
3. Replacing spaces and special characters with hyphens (`-`).

A script (`prisma/seed.cjs` or a new script) can be used for this one-time update.

```javascript
// Example slug generation logic
function generateSlug(name) {
  return name
    .toLowerCase()
    .replace(/[^a-z0-9\s-]/g, '') // remove special characters
    .replace(/\s+/g, '-')         // replace spaces with hyphens
    .replace(/-+/g, '-');          // remove consecutive hyphens
}
```

### 4. Backend API Update (Next.js API Route)

The backend API endpoint for fetching a single product needs to be able to find a product by its slug. The file `app/api/v1/products/[id]/route.ts` (or similar) would be modified to handle a slug instead of an ID.

*This part of the implementation is pending, as the API needs to be located and updated.*

### 5. Frontend Route Renaming

The folder for the product detail page was renamed to use the slug as the dynamic parameter.

- **From:** `app/(store)/product/[id]/`
- **To:** `app/(store)/product/[slug]/`

### 6. Frontend Product Page Update

The product detail page component (`app/(store)/product/[slug]/page.tsx`) was updated to fetch the product using the `slug` from the URL parameters.

```typescript
// file: app/(store)/product/[slug]/page.tsx

// The parameter is now 'slug' instead of 'id'
async function getProduct(params: { slug: string }) {
  const { slug } = params;
  // The API endpoint will need to support fetching by slug
  const res = await fetch(`http://localhost:3000/api/v1/products/${slug}`, { cache: 'no-store' });
  // ... rest of the function
}

export default async function ProductDetailPage({ params }: { params: { slug: string } }) {
  // ...
}
```

### 7. Frontend Link Updates (`ProductCard`)

The `ProductCard` component was updated to link to the new slug-based URL.

```tsx
// file: src/components/product-card.tsx

// The href now uses product.slug
<Link href={`/product/${product.slug}`} className="block">
  {/* ... */}
</Link>
```

## üêõ Image URL Bug Fix

While implementing the slug feature, a bug was found in `src/components/product-card.tsx`. The component was trying to access `product.imageUrl` which does not exist on the `Product` type. The correct property is `imageUrls` (an array of strings).

**The fix:**
The `ProductImage` component's `src` prop was updated to correctly use the `imageUrls` array.

```tsx
// file: src/components/product-card.tsx

// Before
const displayImage = product.imageUrl;

// After (simplified, actual implementation might be more robust)
const displayImage = product.imageUrls[0];
```

This ensures that the correct product image is displayed on the product card.

## üìù For Trainee Developers

When adding a new product, you don't need to manually create a slug. The slug should be generated automatically when the product is created or updated, based on its name. Ensure that the backend logic for creating/updating products includes this slug generation step.

If you encounter a 404 error on a product page, check the following:
1.  Does the product exist in the database?
2.  Does it have a valid, unique slug?
3.  Is the URL you are visiting matching the slug in the database exactly?
